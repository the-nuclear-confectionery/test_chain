type: object
required:
  - global
  - input
additionalProperties: false
properties:
  global:
    type: object
    required:
      - output
      - tmp
      - basedir
      - nevents
      - grid
      - energy
      - tau_hydro
    additionalProperties: false
    properties:
      output:
        type: string
        description: "Global output directory path."
      tmp:
        type: string
        description: "Temporary directory path."
      basedir:
        type: string
        description: "Path to the tables directory."
      nevents:
        type: integer
        minimum: 1
        description: "Number of events to simulate."
      grid:
        type: object
        required:
          - x_max
          - y_max
          - eta_max
          - step_x
          - step_y
          - step_eta
        additionalProperties: false
        properties:
          x_max:
            type: number
            description: "Grid maximum extent in x-direction."
          y_max:
            type: number
            description: "Grid maximum extent in y-direction."
          eta_max:
            type: number
            description: "Grid maximum extent in eta direction."
          step_x:
            type: number
            description: "Grid step size in x-direction."
          step_y:
            type: number
            description: "Grid step size in y-direction."
          step_eta:
            type: number
            description: "Grid step size in eta direction."
      energy:
        type: object
        required:
          - value
          - unit
        additionalProperties: false
        properties:
          value:
            type: number
            description: "Collision energy."
          unit:
            type: string
            enum:
              - GeV
              - TeV
            description: "Unit of the collision energy."
      tau_hydro:
        type: number
        description: "Time where hydrodynamics starts."
        default: 1.0
      ion_A:
        type: string
      ion_B:
        type: string

  input:
    type: object
    additionalProperties: false
    properties:
      initial_conditions:
        type: object
        additionalProperties: false
        properties:
          type:
            type: string
            enum:
              - Trento
              - ampt
            description: "Type of initial conditions to be used (Trento or ampt)."
          parameters:
            type: object
        allOf:
          - if:
              properties:
                type:
                  const: Trento
            then:
              properties:
                parameters:
                  type: object
                  additionalProperties: false
                  properties:
                    ion_A:
                      type: object
                      additionalProperties: false
                      properties:
                        species:
                          type: string
                          enum:
                            - p
                            - d
                            - Cu
                            - Zr
                            - Ru
                            - Xe
                            - Au
                            - Pb
                            - U
                          description: "Species of the first ion (e.g., Pb, Au)."
                    ion_B:
                      type: object
                      additionalProperties: false
                      properties:
                        species:
                          type: string
                          enum:
                            - p
                            - d
                            - Cu
                            - Zr
                            - Ru
                            - Xe
                            - Au
                            - Pb
                            - U
                          description: "Species of the second ion (e.g., Pb, Au)."
                    fluctuation:
                      type: number
                      default: 1.6
                      description: "Fluctuation parameter for TRENTo."
                    number-events:
                      type: integer
                      default: 1
                      description: "Number of events to be simulated in TRENTo."
                    entropy-dict-dir:
                      type: string
                      default: "default"
                      description: "Path to the entropy dictionary directory."
                    quiet:
                      type: boolean
                      default: false
                      description: "Suppress output if true."
                    no-header:
                      type: boolean
                      default: false
                      description: "Do not write headers to output files if true."
                    ncoll:
                      type: boolean
                      default: false
                      description: "Flag to include binary collisions in the output."
                    sparse-output:
                      type: boolean
                      default: true
                      description: "Use sparse output format for generated events."
                    output-format:
                      type: boolean
                      default: true
                      description: "Use HDF5 or both text and HDF5 formats for output."
                    reduced-thickness:
                      type: number
                      default: 0.0
                      description: "Reduced thickness parameter in TRENTo."
                    fluctuation-type:
                      type: string
                      default: "Gamma"
                      enum:
                        - Gamma
                        - LogNormal
                      description: "Fluctuation distribution type (Gamma or LogNormal)."
                    nucleon-width:
                      type: number
                      default: 0.3
                      description: "Gaussian nucleon width."
                    nucleon-width-probability:
                      type: number
                      default: 0.0
                      description: "Probability for nucleon width distribution."
                    constit-width:
                      type: number
                      default: 0.3
                      description: "Gaussian constituent width."
                    constit-number:
                      type: integer
                      default: 1
                      description: "Number of constituents per nucleon."
                    nucleon-min-dist:
                      type: number
                      default: 0.0
                      description: "Minimum allowed distance between nucleons."
                    number-nucleons:
                      type: integer
                      default: 208
                      description: "Number of nucleons per ion (assuming Pb)."
                    woods-saxon-radius:
                      type: number
                      default: 5.09
                      description: "Woods-Saxon nuclear radius."
                    woods-saxon-thickness:
                      type: number
                      default: 0.46
                      description: "Woods-Saxon skin thickness."
                    woods-saxon-omega:
                      type: number
                      default: 0.0
                      description: "Woods-Saxon deformation parameter omega."
                    beta2:
                      type: number
                      default: 0.0
                      description: "Deformation parameter beta2."
                    beta3:
                      type: number
                      default: 0.0
                      description: "Deformation parameter beta3."
                    beta4:
                      type: number
                      default: 0.0
                      description: "Deformation parameter beta4."
                    cross-section:
                      type: number
                      default: 7.0
                      description: "Inelastic nucleon-nucleon cross-section in fm²."
                    normalization:
                      type: number
                      default: 1.0
                      description: "Normalization factor for entropy deposition."
                    b-min:
                      type: number
                      default: 0.0
                      description: "Minimum impact parameter in fm."
                    b-max:
                      type: number
                      default: -1.0
                      description: "Maximum impact parameter (-1 means auto-detect)."
                    centrality-min:
                      type: number
                      default: -10.0
                      description: "Minimum centrality percentage."
                    centrality-max:
                      type: number
                      default: -100.0
                      description: "Maximum centrality percentage."
                    reduced-thickness-form:
                      type: string
                      default: "default"
                      description: "To be determined"
                    seed:
                      anyOf:
                        - type: string
                        - type: integer
                      default: "random"
                      description: "Accepts 'random' or an integer value as the random seed."
          - if:
              properties:
                type:
                  const: ampt
            then:
              properties:
                parameters:
                  type: object
                  additionalProperties: false
                  properties:
                    ion_A:
                      type: object
                      additionalProperties: false
                      properties:
                        species:
                          type: string
                          enum:
                            - p
                            - d
                            - Cu
                            - Zr
                            - Ru
                            - Xe
                            - Au
                            - Pb
                            - U
                          description: "Species of the first ion (e.g., Pb, Au)."
                    ion_B:
                      type: object
                      additionalProperties: false
                      properties:
                        species:
                          type: string
                          enum:
                            - p
                            - d
                            - Cu
                            - Zr
                            - Ru
                            - Xe
                            - Au
                            - Pb
                            - U
                          description: "Species of the second ion (e.g., Pb, Au)."
                    EFRM:
                      type: number
                      default: 502000
                      description: "sqrt(S_NN) in GeV if FRAME is CMS."
                    FRAME:
                      type: string
                      enum:
                        - CMS
                      default: CMS
                      description: "Collision frame."
                    PROJ:
                      type: string
                      default: "A"
                      description: "Projectile."
                    TARG:
                      type: string
                      default: "A"
                      description: "Target."
                    IAP:
                      type: integer
                      default: 207
                      description: "Projectile A number."
                    IZP:
                      type: integer
                      default: 82
                      description: "Projectile Z number."
                    IAT:
                      type: integer
                      default: 207
                      description: "Target A number."
                    IZT:
                      type: integer
                      default: 82
                      description: "Target Z number."
                    NEVNT:
                      type: integer
                      default: 1
                      description: "Total number of events."
                    BMIN:
                      type: number
                      default: 0.0
                      description: "Minimum impact parameter in fm."
                    BMAX:
                      type: number
                      default: 50.0
                      description: "Maximum impact parameter in fm."
                    ISOFT:
                      type: integer
                      default: 4
                      description: "Select Default AMPT or String Melting."
                    NTMAX:
                      type: integer
                      default: 150
                      description: "Number of timesteps."
                    DT:
                      type: number
                      default: 0.2
                      description: "Timestep in fm."
                    PARJ41:
                      type: number
                      default: 0.55
                      description: "Parameter a in Lund symmetric splitting function."
                    PARJ42:
                      type: number
                      default: 0.15
                      description: "Parameter b in Lund symmetric splitting function."
                    popcorn:
                      type: integer
                      default: 1
                      description: "Flag for popcorn mechanism (1 for yes, 0 for no)."
                    PARJ5:
                      type: number
                      default: 1.0
                      description: "Parameter to control baryon-antibaryon production in popcorn."
                    shadowing_flag:
                      type: integer
                      default: 1
                      description: "Flag for shadowing (1 for yes, 0 for no)."
                    quenching_flag:
                      type: integer
                      default: 0
                      description: "Flag for quenching (0 for no, 1 for yes)."
                    quenching_parameter:
                      type: number
                      default: 2.0
                      description: "Quenching parameter -dE/dx (GeV/fm)."
                    p0_cutoff:
                      type: number
                      default: 2.0
                      description: "p0 cutoff in HIJING for minijet productions."
                    parton_screening_mass:
                      type: number
                      default: 2.265
                      description: "Parton screening mass in fm^(-1)."
                    IZPC:
                      type: integer
                      default: 0
                      description: "Flag for forward-angle parton scatterings."
                    alpha:
                      type: number
                      default: 0.33
                      description: "Alpha in parton cascade."
                    dpcoal:
                      type: number
                      default: !!float 1e6
                      description: "dpcoal in GeV."
                    drcoal:
                      type: number
                      default: !!float 1e6
                      description: "drcoal in fm."
                    ihjsed:
                      type: integer
                      default: 0
                      description: "HIJING seed flag, if 11 will generate seed at ampt runtime"
                    hijing_seed:
                      anyOf:
                        - type: string
                        - type: integer
                      default: "random"
                      description: "Accepts 'random' or an integer value as the random seed."
                    parton_cascade_seed:
                      anyOf:
                        - type: string
                        - type: integer
                      default: "random"
                      description: "Accepts 'random' or an integer value as the random seed."
                    k0s_decay_flag:
                      type: integer
                      default: 0
                      description: "Flag for K0s weak decays."
                    phi_decay_flag:
                      type: integer
                      default: 1
                      description: "Flag for phi decays at end of hadron cascade."
                    pi0_decay_flag:
                      type: integer
                      default: 0
                      description: "Flag for pi0 decays at end of hadron cascade."
                    oscar_output:
                      type: integer
                      default: 3
                      description: "Optional OSCAR output flag."
                    perturbative_deuteron_flag:
                      type: integer
                      default: 0
                      description: "Flag for perturbative deuteron calculation."
                    perturbative_deuteron_factor:
                      type: integer
                      default: 1
                      description: "Integer factor for perturbative deuterons (>=1 & <=10000)."
                    deuteron_cross_section_choice:
                      type: integer
                      default: 1
                      description: "Choice of cross section assumptions for deuteron reactions."
                    pttrig:
                      type: number
                      default: -7.0
                      description: "Pt threshold in GeV to require at least one minijet."
                    maxmiss:
                      type: integer
                      default: 1000
                      description: "Maximum number of tries to repeat a HIJING event."
                    initial_final_radiation_flag:
                      type: integer
                      default: 3
                      description: "Flag on initial and final state radiation."
                    kt_kick_flag:
                      type: integer
                      default: 1
                      description: "Flag on Kt kick."
                    quark_pair_embedding_flag:
                      type: integer
                      default: 0
                      description: "Flag to turn on quark pair embedding."
                    embedded_quark_initial_px:
                      type: number
                      default: 7
                      description: "Initial Px value (GeV) of the embedded quark."

                    embedded_quark_initial_py:
                      type: number
                      default: 0
                      description: "Initial Py value (GeV) of the embedded quark."

                    embedded_quark_initial_x:
                      type: number
                      default: 0
                      description: "Initial x position (fm) of the embedded quark."

                    embedded_quark_initial_y:
                      type: number
                      default: 0
                      description: "Initial y position (fm) of the embedded quark."
                    nsembd:
                      type: integer
                      default: 1
                      description: "Number of soft pions to be embedded."
                    psembd:
                      type: number
                      default: 5.0
                      description: "Momentum of each embedded soft pion in GeV."
                    tmaxembd:
                      type: number
                      default: 0.0
                      description: "Maximum angle (radian) for embedded soft pions."
                    ishadow:
                      type: integer
                      default: 0
                      description: "Flag to enable users to modify shadowing."
                    dshadow:
                      type: number
                      default: 1.0
                      description: "Factor used to modify nuclear shadowing."
                    iphirp:
                      type: number
                      default: 0
                      description: "Flag for random orientation of reaction plane."


      overlay:
        type: object
        additionalProperties: false
        properties:
          type:
            type: string
            enum: [ICCING, AMPTGenesis]
            description: "Type of overlay (ICCING or AMPTGenesis)."
          parameters:
            type: object
        allOf:
          - if:
              properties:
                type:
                  const: ICCING
            then:
              properties:
                parameters:
                  type: object
                  additionalProperties: false
                  properties:
                    seed:
                      anyOf:
                        - type: string
                        - type: integer
                      default: "random"
                      description: "Seed for ICCING."
                    input_type:
                      type: string
                      enum: [sparse, full]
                      default: sparse
                      description: "Sparse or full input type."
                    output_type:
                      type: string
                      enum: [sparse, full]
                      default: sparse
                      description: "Sparse or full output type."
                    density_profile_type:
                      type: string
                      enum: [Gaussian, Kernel]
                      default: Kernel
                      description: "Density profile type."
                    dipole_model:
                      type: string
                      enum: [GBW, MV]
                      default: GBW
                      description: "Dipole model (GBW or MV)."
                    charge_type:
                      type: string
                      enum: [BSQ, UDS]
                      default: BSQ
                      description: "Charge type (BSQ or UDS)."
                    eccentricity_type:
                      type: string
                      default: COM
                      description: "Eccentricity type."
                    greens_evolution:
                      type: integer
                      default: 0
                      description: "Enable or disable greens evolution (0 for false, 1 for true)."
                    t_a:
                      type: integer
                      default: 0
                      description: "Flag to include t_a contribution (0 for false, 1 for true)."
                    t_b:
                      type: integer
                      default: 1
                      description: "Flag to include t_b contribution (0 for false, 1 for true)."
                    trento_normalization: 
                      type: number
                      default: 1
                      description: "Normalization factor for TRENTo."
                    alpha_s:
                      type: number
                      default: 0.3
                      description: "Strong coupling constant alpha_s."
                    kappa:
                      type: integer
                      default: 1
                      description: "Kappa parameter in GeV."
                    gluon_radius:
                      type: number
                      default: 0.5
                      description: "Gluon radius in fm."
                    quark_radius:
                      type: number
                      default: 1.0
                      description: "Quark radius in fm."
                    r_max:
                      type: integer
                      default: 1
                      description: "Maximum r value in fm."
                    alpha_min:
                      type: number
                      default: 0.01
                      description: "Minimum alpha value."
                    s_chop:
                      type: number
                      default: 1.0e-19
                      description: "Chopping threshold for s in fm^-3."
                    e_thresh:
                      type: number
                      default: 0.25
                      description: "Energy threshold in GeV/fm^3."
                    lambda:
                      type: integer
                      default: 1
                      description: "Lambda parameter."
                    lambda_bym:
                      type: number
                      default: 0.001
                      description: "Lambda/m parameter."
                    perturbative_regime:
                      type: number
                      default: 0.9
                      description: "Perturbative regime parameter."
                    background_points:
                      type: integer
                      default: 10146
                      description: "Number of background points."
                    greens_functions_points:
                      type: integer
                      default: 128
                      description: "Number of Greens function points."
                    greens_functions_chunks:
                      type: integer
                      default: 400
                      description: "Number of Greens function chunks."
                    c_infinity:
                      type: number
                      default: 0.8846609
                      description: "Value of c_infinity."
                    eta_over_s:
                      type: number
                      default: 0.047
                      description: "Viscosity over entropy ratio."
                    paths:
                      type: object
                      additionalProperties: false
                      properties:
                        trento_results_directory:
                          type: string
                          default: default
                          description: "Directory containing TRENTo results."
                        EoS:
                          type: string
                          default: default
                          description: "Path to the equation of state (EoS) file."
                        background_attractor:
                          type: string
                          default: default
                          description: "Path to the background attractor file."
                        executable_directory:
                          type: string
                          default: default
                          description: "Path to the directory containing the ICCING executable."
                        greens_functions:
                          type: string
                          default: default
                          description: "Path to the Greens functions file."
                        quark_chemistry:
                          type: string
                          default: default
                          description: "Path to the quark chemistry file."
                        results_directory:
                          type: string
                          default: default
                          description: "Directory where ICCING results will be stored."

          - if:
              properties:
                type:
                  const: AMPTGenesis
            then:
              properties:
                parameters:
                  type: object
                  additionalProperties: false
                  properties:
                    paths:
                      type: object
                      properties:
                        input:
                          type: string
                          default: default
                          description: "Path to the input directory."
                        output:
                          type: string
                          default: default
                          description: "Path to the output directory."
                    smearing:
                      type: object
                      properties:
                        sigma_r:
                          type: number
                          default: 0.6
                          description: "Smearing parameter for radial direction in fm."
                        sigma_eta:
                          type: number
                          default: 0.6
                          description: "Smearing parameter for eta direction."
                        K:
                          type: number
                          default: 2.0
                          description: "Normalization factor for smearing."

      preequilibrium:
        type: object
        properties:
          type:
            type: string
            enum: [freestreaming]
        properties:
          input_file:
            type: string
            default: default
            description: "Path to the input file for preequilibrium."
        
      hydrodynamics:
        type: object
        properties:
          type:
            type: string
            enum: [CCAKE]
        properties:
          initial_conditions:
            type: object
            additionalProperties: false
            properties:
              type:
                type: string
                enum: [ccake, ICCING, default]
                default: default
                description: "Type of initial conditions to be used (ccake, iccing)."
              file:
                type: string
                default: default
                description: "Path to the initial conditions file."
              dimension:
                type: integer
                enum: [1, 2, 3]
                default: 2
                description: "Spatial dimension of the simulation."
              input_as_entropy:
                type: boolean
                default: false
                description: "Interpret input as entropy density if true."
              coordinate_system:
                type: string
                enum: [cartesian, hyperbolic]
                default: hyperbolic
                description: "Coordinate system used in the simulation."
          parameters:
            type: object
            required:
              - dt
              - h_T
              - kernel_type
              - energy_cutoff
            additionalProperties: false
            properties:
              dt:
                type: number
                default: 0.05
                description: "Time step of the simulation in fm/c."
              h_T:
                type: number
                default: 0.5
                description: "Smoothing parameter in the transverse direction (in fm)."
              h_eta:
                type: number
                default: 0.5
                description: "Smoothing parameter in the longitudinal direction."
              rk_order:
                type: integer
                default: 2
                description: "Order of the Runge-Kutta integrator."
              kernel_type:
                type: string
                enum: [cubic_spline]
                default: cubic_spline
                description: "Kernel type for smoothing."
              energy_cutoff:
                type: number
                default: 0.0
                description: "Energy threshold (GeV/fm³) below which particles are deleted."
              max_tau:
                type: number
                default: 30.0
                description: "Maximum simulation time in fm/c."
              buffer_particles:
                type: object
                additionalProperties: false
                properties:
                  enabled:
                    type: boolean
                    default: false
                    description: "Enable or disable buffer particles."
                  circular:
                    type: boolean
                    default: false
                    description: "Use circular grid padding if true."
                  padding_thickness:
                    type: number
                    default: 0.1
                    description: "Fractional padding thickness for circular buffering."

          eos:
            type: object
            required:
              - type
            properties:
              type:
                type: string
                enum: [table, tanh_conformal, conformal, conformal_diagonal]
                default: table
                description: "Equation of state (EoS) type."
              path:
                type: string
                default: default
                description: "Path to the EoS file (required if `type` is 'table')."
              online_inverter_enabled:
                type: boolean
                default: false
                description: "Enable or disable online interpolation of EoS tables."
              preinverted_eos_path:
                type: string
                default: default
                description: "Path to the pre-inverted EoS file (required if `type` is 'table')."

          particlization:
            type: object
            properties:
              enabled:
                type: boolean
                default: true
                description: "Enable or disable particlization output."
              type:
                type: string
                enum: [fixed_T]
                default: fixed_T
                description: "Type of particlization."
              T:
                type: number
                default: 150.0
                description: "Particlization temperature (in MeV)."

          hydro:
            type: object
            properties:
              baryon_charge_enabled:
                type: boolean
                default: false
                description: "Enable baryon charge evolution."
              strange_charge_enabled:
                type: boolean
                default: false
                description: "Enable strange charge evolution."
              electric_charge_enabled:
                type: boolean
                default: false
                description: "Enable electric charge evolution."
              viscous_parameters:
                type: object
                properties:
                  shear:
                    type: object
                    properties:
                      mode:
                        type: string
                        enum: [constant, disabled]
                        default: constant
                        description: "Shear viscosity mode."
                      constant_eta_over_s:
                        type: number
                        default: 0.
                        description: "Constant shear viscosity value."
                      relaxation_mode:
                        type: string
                        enum: [default, gubser]
                        default: default
                        description: "Shear relaxation coefficient mode."
                  bulk:
                    type: object
                    properties:
                      mode:
                        type: string
                        enum: [constant]
                        default: constant
                        description: "Bulk viscosity mode."
                      constant_zeta_over_s:
                        type: number
                        default: 0.
                        description: "Constant bulk viscosity value."
                      cs2_dependent_zeta_A:
                        type: number
                        default: 1.67552
                        description: "Zeta coefficient A."
                      cs2_dependent_zeta_p:
                        type: number
                        default: 2.
                        description: "Zeta coefficient power term."
                      relaxation_mode:
                        type: string
                        enum: [default]
                        default: default
                        description: "Bulk relaxation coefficient mode."
                      modulate_with_tanh:
                        type: boolean
                        default: false
                        description: "Use tanh modulation for bulk viscosity."

          output:
            type: object
            properties:
              print_conservation_state:
                type: boolean
                default: false
                description: "Print conservation state to output."
              hdf_evolution:
                type: boolean
                default: false
                description: "Output evolution data in HDF format."
              txt_evolution:
                type: boolean
                default: false
                description: "Output evolution data in TXT format."
              calculate_observables:
                type: boolean
                default: false
                description: "Calculate observables during the simulation."
              check_causality:
                type: boolean
                default: false
                description: "Check for causality violations during the simulation."
              

      particlization:
        type: object
        properties:
          type:
            type: string
            enum: [is3d, analytical, BQSSampler]      
        allOf:
          # ---- iS3D ----
          - if:
              properties: { type: { const: is3d } }
            then:
              properties:
                parameters:
                  type: object
                  additionalProperties: false
                  properties:
                    input_file:
                      type: string
                      default: default
                      description: "Path to freezeout surface file for iS3D."
                    operation: { type: integer, enum: [0,1,2], default: 2 }
                    mode:
                      anyOf:
                        - { type: string, enum: ["default"] }
                        - { type: integer, enum: [0,1,2,3,4,5,6,7,8,9,10] }
                      default: "default"
                    hrg_eos: { type: integer, enum: [1,2,3], default: 2 }
                    set_FO_temperature: { type: integer, enum: [0,1], default: 0 }
                    T_switch: { type: number, default: 0.150 }
                    dimension: { type: integer, enum: [2,3], default: 2 }
                    df_mode: { type: integer, default: 8 }
                    include_baryon: { type: integer, default: 1 }
                    include_bulk_deltaf: { type: integer, default: 0 }
                    include_shear_deltaf: { type: integer, default: 1 }
                    include_baryondiff_deltaf: { type: integer, default: 0 }
                    regulate_deltaf: { type: integer, default: 1 }
                    outflow: { type: integer, default: 1 }
                    deta_min: { type: number, default: 1.0e-5 }
                    group_particles: { type: integer, default: 0 }
                    particle_diff_tolerance: { type: number, default: 0.01 }
                    mass_pion0: { type: number, default: 0.180 }
                    do_resonance_decays: { type: integer, default: 0 }
                    lightest_particle: { type: integer, default: 111 }
                    oversample: { type: integer, default: 1 }
                    min_num_hadrons: { type: number, default: 1.0e+8 }
                    max_num_samples: { type: integer, default: 1 }
                    fast: { type: integer, default: 0 }
                    y_cut: { type: number, default: 5.0 }
                    seed:
                      anyOf: [{ type: string }, { type: integer }]
                      default: "random"
                    test_sampler: { type: integer, default: 0 }
                    pT_lower_cut: { type: number, default: 0.0 }
                    pT_upper_cut: { type: number, default: 3.0 }
                    pT_bins: { type: integer, default: 100 }
                    y_bins: { type: integer, default: 50 }
                    eta_cut: { type: number, default: 7.0 }
                    eta_bins: { type: integer, default: 70 }
                    tau_min: { type: number, default: 0.0 }
                    tau_max: { type: number, default: 12.0 }
                    tau_bins: { type: integer, default: 120 }
                    r_min: { type: number, default: 0.0 }
                    r_max: { type: number, default: 12.0 }
                    r_bins: { type: integer, default: 60 }
      
          # ---- BQSSampler ----
          - if:
              properties: { type: { const: BQSSampler } }
            then:
              properties:
                parameters:
                  type: object
                  additionalProperties: false
                  properties:
                    input_file:
                      type: string
                      default: default
                      description: "Path to freezeout surface file for BSQ sampler."
                    mode:
                      type: string
                      enum: [ccakev2,ccakev1]
                      default: ccakev2
                    coordinate_system:
                      type: string
                      enum: [cartesian, hyperbolic]
                      default: hyperbolic
                    dimension:
                      type: integer
                      enum: [2,3]
                      default: 3
                    use_muB: { type: boolean, default: false }
                    use_muS: { type: boolean, default: false }
                    use_muQ: { type: boolean, default: false }
                    samples: { type: integer, minimum: 1, default: 100 }
                    sampling_method:
                      type: string
                      enum: [regular, conserved]
                      default: regular
                    delta_f_shear: { type: boolean, default: false }
                    seed:
                      anyOf: [{ type: string }, { type: integer }]
                      default: "random"
                    y_max: { type: number, default: 5.0 }
                    output_file: { type: string, default: default }
                    tables_path: { type: string, default: default }
      
          # ---- analytical ----
          - if:
              properties: { type: { const: analytical } }
            then:
              properties:
                parameters:
                  type: object
                  additionalProperties: true
                  properties:
                    input_file:
                      type: string
                      default: default
                      description: "Path to analytical particlization input file."
                    equations_version:
                      type: string
                      enum: [shear+bulk,idealBSQ, v2]
                      default: v2
                    folder: { type: string }
                    temperature: { type: number, default: 0.150 }
                    decays: { type: integer, enum: [0,1,2,3], default: 0 }
                    event_range:
                      type: array
                      items: { type: integer }
                      minItems: 2
                      maxItems: 2
                      default: [0,0]
                    basis_files:
                      type: array
                      items: { type: string , default: default }
                      minItems: 2
                    df_correction_file: { type: string, default: default }
                    ptphi_grid_file:    { type: string, default: default }
                    hadron_list_file:   { type: string, default: default }
                    hadron_check_file:  { type: string, default: default }
      
      afterburner:
        type: object
        default: {}
        properties:
          type:
            type: string
            enum: [smash, afterdecays, none]   # 'none' lets you explicitly disable
        allOf:
          # ---- SMASH ----
          - if:
              properties: { type: { const: smash } }
              required: [type]
            then:
              properties:
                parameters:
                  type: object
                  additionalProperties: false
                  properties:
                    decays_only:
                      type: boolean
                      default: false
                      description: "If true, only decays are performed without rescattering."
                    input_file:
                      type: string
                      default: default
                      description: "Path to the input file containing freezeout surface data."
                    Logging:
                      type: object
                      properties:
                        default:
                          type: string
                          enum: [DEBUG, INFO, WARN, ERROR]
                          default: INFO
                          description: "Logging level for the simulation."
                    General:
                      type: object
                      properties:
                        Modus:          { type: string, enum: [List],  default: List }
                        Time_Step_Mode: { type: string, enum: [Fixed], default: Fixed }
                        Delta_Time:     { type: number, default: 1.0 }
                        End_Time:       { type: number, default: 1000.0 }
                        seed:
                          anyOf: [{ type: string }, { type: integer }]
                          default: random
                        Nevents:        { type: integer, minimum: 1, default: 1 }
                    Output:
                      type: object
                      properties:
                        Output_Interval: { type: number, default: 1000.0 }
                        Particles:
                          type: object
                          properties:
                            Format:
                              type: array
                              items: { type: string, enum: ["Oscar2013", "HepMC_treeroot"] }
                              default: ["Oscar2013", "HepMC_treeroot"]
                    Collision_Term:
                      type: object
                      properties:
                        No_Collisions:         { type: boolean, default: false }
                        Force_Decays_At_End:   { type: boolean, default: false }
                    Modi:
                      type: object
                      properties:
                        List:
                          type: object
                          properties:
                            File_Directory: { type: string, default: "../input/list" }
                            Filename:       { type: string, default: "particle_list_osc.dat" }

          # ---- AFTERDECAYS ----
          - if:
              properties: { type: { const: afterdecays } }
              required: [type]
            then:
              properties:
                parameters:
                  type: object
                  additionalProperties: false
                  properties:
                    path_to_pT_range:
                      type: string
                      default: default
                      description: "Path to pT grid/basis file (e.g., gl15.dat)."
                    path_to_phi_range:
                      type: string
                      default: default
                      description: "Path to phi grid/basis file (e.g., gq20.dat)."
                    path_to_spectra:
                      type: string
                      default: default
                      description: "Path to input spectra table (e.g., evv2_dNdphidpp.dat)."
                    path_to_resonances:
                      type: string
                      default: default
                      description: "Path to resonance list (e.g., resoweakPDG2016Plus.dat)."
                    path_to_output:
                      type: string
                      default: default
                      description: "Output directory for the decayed spectra."
                    use_corrected:
                      type: boolean
                      default: true
                      description: "Use corrected spectra if true; otherwise, use uncorrected."

      analysis:
        type: object
        properties:
          type:
            type: string
            enum: [qvector_writter]
          parameters:
            type: object
            properties:
              n_max:
                type: integer
                default: 6
                description: "Maximum harmonic order to compute Q-vectors for."
      
              calculate_charged:
                type: boolean
                default: true
                description: "Whether to compute Q-vectors for charged particles."
      
              pids:
                type: array
                items:
                  type: integer
                default: [-211, 211, 321, -321, 2212, -2212, 3122, -3122, 3222, 3112, 3334]
                description: "List of PIDs for identified particle Q-vector analysis."
      
              pt_bins:
                type: integer
                default: 120
                description: "Number of pT bins (ignored if pt_bins_custom is given)."
      
              max_pt:
                type: number
                default: 6.0
                description: "Maximum pT for binning."
      
              eta_bins:
                type: integer
                default: 108
                description: "Number of eta bins (ignored if eta_bins_custom is given)."
      
              max_eta:
                type: number
                default: 5.4
                description: "Maximum eta for binning."
      
              pt_bins_custom:
                type: array
                items:
                  type: number
                description: "Optional custom bin edges for pT."
      
              eta_bins_custom:
                type: array
                items:
                  type: number
                description: "Optional custom bin edges for eta."
      
              input_type:
                type: string
                enum: ["smash_hepmc3", "smash_oscar", "afterdecays","default"]
                default: "default"
                description: "Input format to be parsed."
      
              output_type:
                type: string
                enum: ["text", "root"]
                default: "root"
                description: "Format of output files."
      